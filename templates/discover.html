<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>D√©couvrir et ajouter des s√©ries</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style-discover.css') }}">
</head>
<body>
    <div class="container">
        <header>
            <div class="header-content">
                <div class="header-left">
                    <h1>üéØ D√©couvrir et ajouter des s√©ries</h1>
                    <p class="subtitle">Cherchez, s√©lectionnez une biblioth√®que, puis trouvez des sources</p>
                </div>
                <div style="display: flex; gap: 10px;">
                    <a href="/" class="btn-back">‚Üê Retour aux biblioth√®ques</a>
                </div>
            </div>
        </header>

        <div class="discover-container">
            <!-- √âTAPE 1: Recherche sur Nautiljon -->
            <section class="step" id="step-1">
                <div class="step-header">
                    <h2>üìñ √âtape 1: Rechercher une s√©rie</h2>
                </div>
                
                <div class="search-box">
                    <input 
                        type="text" 
                        id="seriesNameInput" 
                        class="search-input" 
                        placeholder="Entrez le nom d'une s√©rie..."
                        onkeypress="if(event.key === 'Enter') searchNautiljon()"
                    >
                    <button class="btn-primary" onclick="searchNautiljon()">üîç Chercher sur Nautiljon</button>
                </div>

                <div id="nautiljon-loading" class="loading" style="display:none;">
                    Recherche en cours sur Nautiljon...
                </div>

                <div id="nautiljon-results" class="results-box" style="display:none;">
                    <div class="results-header">
                        <h3>R√©sultats trouv√©s</h3>
                        <span id="results-count" class="results-count"></span>
                    </div>
                    <div id="results-list" class="results-list"></div>
                </div>

                <div id="nautiljon-error" class="error-box" style="display:none;"></div>
            </section>

            <!-- √âTAPE 2: S√©lectionner une s√©rie et une biblioth√®que -->
            <section class="step" id="step-2" style="display:none;">
                <div class="step-header">
                    <h2>üìö √âtape 2: Choisir une biblioth√®que</h2>
                    <button class="btn-secondary" onclick="resetToStep1()">Changer de s√©rie</button>
                </div>

                <div class="selection-info">
                    <div class="selected-series">
                        <h3>S√©rie s√©lectionn√©e</h3>
                        <div id="selected-series-display" class="series-display"></div>
                    </div>

                    <div class="library-selection">
                        <h3>Choisir une biblioth√®que</h3>
                        <div id="libraries-list" class="libraries-list"></div>
                    </div>
                </div>

                <div id="library-loading" class="loading" style="display:none;">
                    Chargement des biblioth√®ques...
                </div>

                <div id="series-verification-loading" class="loading" style="display:none;">
                    üìÅ V√©rification de la s√©rie...
                </div>

                <div id="library-error" class="error-box" style="display:none;"></div>
            </section>

            <!-- √âTAPE 3: Recherche dans les sources (EBDZ + Prowlarr) -->
            <section class="step" id="step-3" style="display:none;">
                <div class="step-header">
                    <h2>üîó √âtape 3: Chercher les sources</h2>
                    <button class="btn-secondary" onclick="resetToStep2()">Changer de biblioth√®que</button>
                </div>

                <div class="sources-info">
                    <div class="selected-summary">
                        <h3>R√©sum√©</h3>
                        <div id="selection-summary" class="summary-box"></div>
                    </div>

                    <div class="sources-search">
                        <h3>Recherche dans les sources</h3>
                        <div class="source-controls">
                            <label>
                                <input type="checkbox" id="search-ebdz" checked> EBDZ (EdZ)
                            </label>
                            <label>
                                <input type="checkbox" id="search-prowlarr" checked> Prowlarr
                            </label>
                            <input 
                                type="number" 
                                id="volume-override" 
                                min="1"
                                placeholder="Num√©ro de volume (optionnel)"
                                class="volume-input"
                            >
                            <button class="btn-primary" onclick="searchSources()">üîé Chercher les sources</button>
                        </div>
                    </div>
                </div>

                <div id="sources-loading" class="loading" style="display:none;">
                    Recherche en cours...
                </div>

                <div id="sources-results" class="results-box" style="display:none;">
                    <div class="results-header">
                        <h3>R√©sultats des sources</h3>
                    </div>
                    
                    <div id="ebdz-results" class="source-results" style="display:none;">
                        <h4>üìî R√©sultats EBDZ</h4>
                        <div id="ebdz-list" class="results-list"></div>
                    </div>

                    <div id="prowlarr-results" class="source-results" style="display:none;">
                        <h4>üîé R√©sultats Prowlarr</h4>
                        <div id="prowlarr-list" class="results-list"></div>
                    </div>
                </div>

                <div id="sources-error" class="error-box" style="display:none;"></div>
            </section>
        </div>
    </div>

    <script src="{{ url_for('static', filename='js/search.js') }}"></script>
    <script src="{{ url_for('static', filename='js/discover.js') }}"></script>
</body>
</html>
